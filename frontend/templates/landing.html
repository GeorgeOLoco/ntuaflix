<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NTUAFlix</title>
  <link rel="icon" type="image/png" href="../static/logo.png">
  <link rel="stylesheet" href="/static/css/landing.css">
</head>

<body>
  <div id="loadingScreen" class="loading-screen">
    <img src="../static/logo.png" alt="NTUAFlix Logo" class="loading-logo">
  </div>
  <header class="site-header">
    <img src="../static/logo.png" alt="NTUAFlix Logo">
  </header>
  <div class="container">
    <!-- Inside the Movies Section -->
<div class="movies-section">
  <h2>Movies</h2>
  <form action="" class="search-form">
    <input type="search" required>
    <i class="fa fa-search"></i>
  </form>
  <div id="movies-container"></div>
</div>

<!-- Inside the People Section -->
<div class="people-section">
  <h2>People</h2>
  <form action="" class="search-form">
    <input type="search" required>
    <i class="fa fa-search"></i>
  </form>
  <div id="people-container"></div>
</div>

<!-- FontAwesome Link at the top of your <head> section -->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

    
  </div>

</body>
<script>
  
  const clearBtns = document.querySelectorAll(".clear-btn"); // Modified to select all clear buttons

clearBtns.forEach(btn => {
    btn.addEventListener("click", function() {
        const input = this.previousElementSibling; // Assuming the input is right before the clear button in each form
        input.value = "";
    });
});


  document.addEventListener('DOMContentLoaded', function () {
    fetchData('http://localhost:7117/ntuaflix_api/toptwentymovies', 'movies-container');
    fetchData('http://localhost:7117/ntuaflix_api/toptenpeople', 'people-container');

    setTimeout(() => {
    const loadingScreen = document.getElementById('loadingScreen');
    loadingScreen.style.animationPlayState = 'running';

    // After the loading screen fades out, fade in the main content
    loadingScreen.addEventListener('animationend', () => {
      loadingScreen.style.display = 'none';

      const mainContent = document.querySelector('.container');
      mainContent.style.animationPlayState = 'running';
    });
  }, 5000);
  

  });


  
function filterData(containerId, query) {
    const container = document.getElementById(containerId);
    const items = container.getElementsByClassName('item');

    for (let i = 0; i < items.length; i++) {
        let item = items[i];
        let title = item.querySelector('h3').textContent.toLowerCase();

        if (title.includes(query.toLowerCase())) {
            item.style.display = "";
        } else {
            item.style.display = "none";
        }
    }
}


  function fetchData(url, containerId) {
    fetch(url)
      .then(response => response.json())
      .then(data => {
        displayData(data, containerId);
      })
      .catch(error => console.error('Error fetching data:', error));
  }

  function displayData(data, containerId) {
    const container = document.getElementById(containerId);
    container.innerHTML = ''; // Clear existing content

    data.forEach(item => {
      const div = document.createElement('div');
      div.classList.add('item');
      div.innerHTML = '';
      
      if (containerId === 'movies-container' || containerId === 'people-container') {
        if (item.img_url_asset != null) {
          div.innerHTML += `<img src="${item.img_url_asset.replace('{width_variable}', 'w400')}" alt="${item.primaryName || item.primarytitle}">`;
        }

      }

      if (containerId === 'movies-container') {

        div.innerHTML += `
                <h3>${item.primarytitle}</h3>
                <p>Rating: ${item.averageRate}</p>
                <p>Year: ${item.startYear}</p>`;
        if (item.genres != null) {
          div.innerHTML += `<p>Genre: ${(item.genres).replace(/,/g, ', ')}</p>`;
        }

      } else if (containerId === 'people-container') {


        div.innerHTML += `
                <h3>${item.primaryName}</h3>
                <h3>${item.primaryProfession}</h3>
            `;
      }

      container.appendChild(div);
      setTimeout(() => div.classList.add('item-loaded'), 100);
    });
  }



</script>

</html>